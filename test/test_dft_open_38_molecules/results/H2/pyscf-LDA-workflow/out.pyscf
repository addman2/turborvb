#INFO: **** input file is /home/nkousuke/lustre/toBeSync/turboRVB/05turbo-genius-development/turbogenius_paper/04data/sanity_checks/02pyscf_prep_LDA_via_trexio/00open_boundary/results/H2/pyscf-LDA-workflow/run.py ****

from pyscf_wrapper import Pyscf_wrapper

# input variables
pyscf_chkfile="pyscf.chk"
structure_file="H2.xyz"

# input variables
omp_num_threads=128
charge=0
spin=0
basis="ccecp-ccpv5z"
ecp="ccecp"
scf_method="DFT"
dft_xc="LDA_X,LDA_C_PZ"
solver_newton=False
MP2_flag=False
CCSD_flag=False
pyscf_output="out.pyscf"
twist_average=False
exp_to_discard=0.1
kpt=[0.0, 0.0, 0.0]
kpt_grid=[1, 1, 1]
smearing_method="fermi"
smearing_sigma=0.0

pyscf_calc=Pyscf_wrapper(
                        structure_file=structure_file,
                        chkfile=pyscf_chkfile,
                        )

pyscf_calc.run_pyscf(
                  omp_num_threads=omp_num_threads,
                  charge=charge,
                  spin=spin,
                  basis=basis,
                  ecp=ecp,
                  scf_method=scf_method,
                  dft_xc=dft_xc,
                  solver_newton=solver_newton,
                  MP2_flag=MP2_flag,
                  CCSD_flag=CCSD_flag,
                  pyscf_output=pyscf_output,
                  twist_average=twist_average,
                  exp_to_discard=exp_to_discard,
                  kpt=kpt,
                  kpt_grid=kpt_grid,
                  smearing_method=smearing_method,
                  smearing_sigma=smearing_sigma
                  )
                #INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='spcc-150', release='5.4.0-66-generic', version='#74-Ubuntu SMP Wed Jan 27 22:54:38 UTC 2021', machine='x86_64', processor='x86_64')  Threads 128
Python 3.7.3 (default, Mar 27 2019, 22:11:17) 
[GCC 7.3.0]
numpy 1.21.6  scipy 1.7.3
Date: Wed Dec 28 20:18:53 2022
PySCF version 2.1.1
PySCF path  /home/nkousuke/application/anaconda3/lib/python3.7/site-packages/pyscf

[CONFIG] conf_file /home/nkousuke/.pyscf_conf.py
[INPUT] verbose = 5
[INPUT] max_memory = 505555.44140625 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 2
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = A
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 H      0.000000000000   0.000000000000  -0.700000000000 AA    0.000000000000   0.000000000000  -1.322808287196 Bohr   0.0
[INPUT]  2 H      0.000000000000   0.000000000000   0.700000000000 AA    0.000000000000   0.000000000000   1.322808287196 Bohr   0.0
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] H
[INPUT] 0    0    [8    /1   ]  23.843185         0.0041149
                                10.212443         0.0104644
                                4.374164          0.0280111
                                1.873529          0.0758862
                                0.802465          0.1821062
                                0.343709          0.3485214
                                0.147217          0.3782313
                                0.063055          0.1164241
[INPUT] 0    0    [1    /1   ]  0.068025             1
[INPUT] 0    0    [1    /1   ]  0.17186              1
[INPUT] 0    0    [1    /1   ]  0.434193             1
[INPUT] 0    0    [1    /1   ]  1.096959             1
[INPUT] 1    0    [1    /1   ]  0.236875             1
[INPUT] 1    0    [1    /1   ]  0.641066             1
[INPUT] 1    0    [1    /1   ]  1.734949             1
[INPUT] 1    0    [1    /1   ]  4.695379             1
[INPUT] 2    0    [1    /1   ]  0.451746             1
[INPUT] 2    0    [1    /1   ]  1.155025             1
[INPUT] 2    0    [1    /1   ]  2.953168             1
[INPUT] 3    0    [1    /1   ]  1.100898             1
[INPUT] 3    0    [1    /1   ]  2.968936             1
[INPUT] 4    0    [1    /1   ]  1.81985              1

nuclear repulsion = 0.377983722085714
number of shells = 30
number of NR pGTOs = 124
number of NR cGTOs = 110
basis = ccecp-ccpv5z
ecp = ccecp
CPU time:         2.22


******** <class 'pyscf.df.df_jk.density_fit.<locals>.DensityFitting'> ********
method = DensityFitting-RKS
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = pyscf.chk
max_memory 505555 MB (current use 102 MB)
XC library pyscf.dft.libxc version 5.2.0
    S. Lehtola, C. Steigemann, M. J. Oliveira, and M. A. Marques, SoftwareX 7, 1 (2018)
XC functionals = LDA_X,LDA_C_PZ
    P. A. M. Dirac, Math. Proc. Cambridge Philos. Soc. 26, 376 (1930)
    F. Bloch, Z. Phys. 57, 545 (1929)
    J. P. Perdew and A. Zunger, Phys. Rev. B 23, 5048 (1981)
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x14f6827aa158>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x14f6827aa048>
small_rho_cutoff = 1e-07
Set gradient conv threshold to 3.16228e-05
atom H rad-grids = 50, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  86  86  86  86
 266 266 266 266 302 302 302 302 302 302 302 302 302 302 302 302 302 266
 266 266 266 266 266 266 266 266 266 266 266 266 266 266]
tot_boxes 891, boxes in each direction [7 7 9]
Padding 0 grids
tot grids = 20048
Drop grids 1050
prune_by_density_: 2 padding grids
    CPU time for setting up grids     12.56 sec, wall time      0.16 sec
nelec by numeric integration = 1.999916238905762
    CPU time for vxc     14.73 sec, wall time      0.13 sec
Even tempered Gaussians are generated as DF auxbasis for  H
  ETB auxbasis for H  [[0, [32.28416, 1]], [0, [16.14208, 1]], [0, [8.07104, 1]], [0, [4.03552, 1]], [0, [2.01776, 1]], [0, [1.00888, 1]], [0, [0.50444, 1]], [0, [0.25222, 1]], [0, [0.12611, 1]], [1, [15.643335091980866, 1]], [1, [7.821667545990433, 1]], [1, [3.9108337729952165, 1]], [1, [1.9554168864976083, 1]], [1, [0.9777084432488041, 1]], [1, [0.48885422162440206, 1]], [1, [0.24442711081220103, 1]], [2, [7.58, 1]], [2, [3.79, 1]], [2, [1.895, 1]], [2, [0.9475, 1]], [2, [0.47375, 1]]]
num shells = 42, num cGTOs = 110
    CPU time for df-vj      8.93 sec, wall time      0.07 sec
E1 = -1.732940061986892  Ecoul = 1.0429842646959855  Exc = -0.5739123482005862
init E= -0.885884423405778
cond(S) = 7635.508366067686
    CPU time for initialize scf     54.55 sec, wall time      0.65 sec
  HOMO = -0.282924037523512  LUMO = -0.0821114277483065
  mo_energy =
[-0.28292404 -0.08211143  0.09717016  0.15801493  0.23724483  0.23724483
  0.40266969  0.44942974  0.44942974  0.69397331  0.70875942  0.72823763
  1.06196879  1.06197009  1.16927201  1.16927201  1.3546242   1.35462633
  1.38139221  1.55827607  1.55827607  1.67024487  1.67024487  1.74305942
  1.8041817   1.8041817   1.83294228  2.20380853  2.52258657  3.13089499
  3.79820468  3.79820468  3.91071289  3.93638047  3.93638339  4.19192435
  4.19192435  4.26931     4.2693111   4.38204099  4.38204099  4.38562668
  4.38562693  4.65909019  4.65909019  4.6731902   4.6731902   4.87772566
  4.87773191  4.96557255  5.11099884  5.27147512  5.27147512  5.30657602
  5.30657602  5.38903464  5.96704694  6.06584396  6.06584396  7.85988441
  8.97866705  8.97866877  9.08157173  9.08157173  9.17537131  9.27522416
  9.27522416  9.44304283  9.44305124  9.48231958  9.48232805  9.65758902
  9.65758902 10.27916519 10.27916633 10.47659192 10.54213164 11.11371341
 11.11371341 11.17843313 12.87424465 12.87427647 12.88037009 12.88037009
 13.00186146 13.00189234 13.11721624 13.62928178 13.62928178 14.62379167
 14.62382293 14.68360559 14.68360559 14.78758989 14.78758989 14.82274902
 15.03301578 15.03301578 15.11808684 15.11811827 15.60119272 15.86599973
 15.86599973 16.31494099 16.44306317 16.44306317 16.74813254 16.74813254
 17.4963158  18.84965394]
nelec by numeric integration = 2.000000023257873
    CPU time for vxc     12.91 sec, wall time      0.11 sec
    CPU time for df-vj      4.04 sec, wall time      0.03 sec
E1 = -1.8904463545058623  Ecoul = 0.9790775894413898  Exc = -0.5193678671520208
cycle= 1 E= -1.05275291013078  delta_E= -0.167  |g|= 0.0235  |ddm|= 1.91
    CPU time for cycle= 1     19.19 sec, wall time      0.17 sec
  HOMO = -0.304803646745145  LUMO = -0.104970391945686
  mo_energy =
[-0.30480365 -0.10497039  0.08669526  0.14529468  0.22283877  0.22283877
  0.38465146  0.43470998  0.43470998  0.67765072  0.69203393  0.71209709
  1.04765311  1.04765403  1.15364356  1.15364356  1.33990483  1.33990637
  1.35984545  1.53747759  1.53747759  1.64966429  1.64966429  1.72226947
  1.78756756  1.78756756  1.81361308  2.18198037  2.4964675   3.10626966
  3.78003957  3.78003957  3.89118459  3.91821695  3.91821983  4.17450046
  4.17450046  4.2468626   4.24686442  4.36414194  4.36414194  4.36529016
  4.36529106  4.63536575  4.63536575  4.64682157  4.64682157  4.855931
  4.85593652  4.93777259  5.08151667  5.24469507  5.24469507  5.27787598
  5.27787598  5.3650221   5.938044    6.04095752  6.04095752  7.83153183
  8.95444688  8.95444867  9.05780714  9.05780714  9.14986607  9.25234865
  9.25234865  9.4216999   9.42169996  9.46095139  9.46095147  9.63513175
  9.63513175 10.25673729 10.2567381  10.44311116 10.50666689 11.09101304
 11.09101304 11.15358557 12.84111174 12.84114421 12.8473504  12.8473504
 12.96871087 12.96874241 13.08296601 13.59435367 13.59435367 14.59265141
 14.59268302 14.65310777 14.65310777 14.75685219 14.75685219 14.78593521
 15.00004268 15.00004268 15.08587064 15.08590243 15.56670058 15.83353726
 15.83353726 16.283172   16.40502071 16.40502071 16.71060155 16.71060155
 17.45951188 18.81459227]
nelec by numeric integration = 2.000000027384924
    CPU time for vxc     12.81 sec, wall time      0.11 sec
    CPU time for df-vj      4.83 sec, wall time      0.04 sec
E1 = -1.8939656141024368  Ecoul = 0.9877454069275974  Exc = -0.5247455628773068
cycle= 2 E= -1.05298204796643  delta_E= -0.000229  |g|= 0.00248  |ddm|= 0.0777
    CPU time for cycle= 2     19.13 sec, wall time      0.16 sec
  HOMO = -0.301401999807895  LUMO = -0.101975327528782
  mo_energy =
[-0.301402   -0.10197533  0.08861733  0.14735132  0.22513969  0.22513969
  0.38693737  0.43691916  0.43691916  0.67983902  0.69454955  0.71451255
  1.05002826  1.05002918  1.15620489  1.15620489  1.34225731  1.34225887
  1.36306906  1.54038118  1.54038118  1.65251787  1.65251787  1.7247763
  1.79007895  1.79007895  1.81595269  2.18525875  2.5000694   3.10964507
  3.78349187  3.78349187  3.89478312  3.9213169   3.92131979  4.17750689
  4.17750689  4.25015524  4.25015702  4.36714442  4.36714442  4.36866155
  4.36866241  4.63875298  4.63875298  4.64988653  4.64988653  4.85892426
  4.85892983  4.94080723  5.08482172  5.24845226  5.24845226  5.28188206
  5.28188206  5.36903284  5.94184737  6.04429333  6.04429333  7.83532339
  8.95794081  8.9579426   9.06139906  9.06139906  9.15376186  9.25581967
  9.25581967  9.42515057  9.42515133  9.46440279  9.46440356  9.63862969
  9.63862969 10.26036623 10.26036706 10.44781542 10.51138911 11.09494012
 11.09494012 11.15761636 12.84559964 12.84563211 12.8519019  12.8519019
 12.97319307 12.9732246  13.08756041 13.5987825  13.5987825  14.59697794
 14.59700966 14.65738733 14.65738733 14.76112007 14.76112007 14.79023801
 15.00435898 15.00435898 15.09013388 15.09016577 15.57118873 15.83794191
 15.83794191 16.28808062 16.4100163  16.4100163  16.71542053 16.71542053
 17.46439372 18.81913761]
nelec by numeric integration = 2.000000027249357
    CPU time for vxc     12.66 sec, wall time      0.10 sec
    CPU time for df-vj      4.20 sec, wall time      0.03 sec
E1 = -1.8931506294702198  Ecoul = 0.9860136595569816  Exc = -0.5238319626487175
cycle= 3 E= -1.05298521047624  delta_E= -3.16e-06  |g|= 0.000509  |ddm|= 0.00986
    CPU time for cycle= 3     19.39 sec, wall time      0.17 sec
  HOMO = -0.301886691637201  LUMO = -0.10234463135747
  mo_energy =
[-0.30188669 -0.10234463  0.08839149  0.14713102  0.22481615  0.22481615
  0.38663553  0.43664634  0.43664634  0.6795718   0.69420517  0.7142106
  1.04968879  1.04968971  1.15582027  1.15582027  1.34195093  1.34195249
  1.36258816  1.5399927   1.5399927   1.65215529  1.65215529  1.72447249
  1.78973557  1.78973557  1.81565202  2.18482016  2.49959111  3.10918592
  3.7829285   3.7829285   3.89420226  3.9208462   3.92084908  4.17709275
  4.17709275  4.24971634  4.24971813  4.36673956  4.36673956  4.36819878
  4.36819965  4.63828487  4.63828487  4.64949343  4.64949343  4.85851853
  4.8585241   4.94043844  5.08440626  5.24795757  5.24795757  5.28135154
  5.28135154  5.36844176  5.94132026  6.04383436  6.04383436  7.8347908
  8.95744173  8.95744352  9.06086787  9.06086787  9.15318868  9.25533367
  9.25533367  9.42468733  9.42468803  9.46393999  9.46394071  9.63813897
  9.63813897 10.25983337 10.2598342  10.44718949 10.51078581 11.09434363
 11.09434363 11.1570127  12.84501507 12.84504753 12.85128481 12.85128481
 12.97261005 12.97264158 13.086936   13.5981952  13.5981952  14.59639133
 14.59642302 14.6568248  14.6568248  14.76056175 14.76056175 14.78967884
 15.00377596 15.00377596 15.08956786 15.08959973 15.57059089 15.83735225
 15.83735225 16.28738807 16.4093759  16.4093759  16.71480026 16.71480026
 17.46373405 18.81852719]
nelec by numeric integration = 2.0000000272765304
    CPU time for vxc     13.37 sec, wall time      0.11 sec
    CPU time for df-vj      4.50 sec, wall time      0.04 sec
E1 = -1.89330621925258  Ecoul = 0.9863205372540504  Exc = -0.5239833984750097
cycle= 4 E= -1.05298535838783  delta_E= -1.48e-07  |g|= 5.01e-06  |ddm|= 0.00136
    CPU time for cycle= 4     19.32 sec, wall time      0.16 sec
  HOMO = -0.301888415517348  LUMO = -0.102346308270126
  mo_energy =
[-0.30188842 -0.10234631  0.08839303  0.14713225  0.2248152   0.2248152
  0.38663335  0.43664622  0.43664622  0.6795706   0.69420396  0.71421032
  1.04968795  1.04968888  1.15581889  1.15581889  1.3419508   1.34195236
  1.36258595  1.53999094  1.53999094  1.65215408  1.65215408  1.72447047
  1.78973431  1.78973431  1.81564946  2.18481874  2.49958879  3.10918347
  3.78292705  3.78292705  3.8942005   3.92084484  3.92084772  4.17709265
  4.17709265  4.24971508  4.24971687  4.36673947  4.36673947  4.36819834
  4.3681992   4.63828274  4.63828274  4.64949006  4.64949006  4.85851648
  4.85852204  4.94043498  5.08440262  5.24795578  5.24795578  5.28134945
  5.28134945  5.36843985  5.94131663  6.04383158  6.04383158  7.83478736
  8.95743939  8.95744118  9.06086547  9.06086547  9.15318609  9.2553321
  9.2553321   9.42468696  9.42468766  9.46393962  9.46394034  9.63813759
  9.63813759 10.25983167 10.2598325  10.44718631 10.51078233 11.09434184
 11.09434184 11.15701038 12.8450125  12.84504496 12.85128166 12.85128166
 12.97260749 12.97263901 13.08693238 13.59819151 13.59819151 14.59638866
 14.59642035 14.65682282 14.65682282 14.76055972 14.76055972 14.78967453
 15.00377257 15.00377257 15.08956492 15.08959679 15.57058731 15.83734924
 15.83734924 16.28738516 16.40937238 16.40937238 16.71479653 16.71479653
 17.46372991 18.81852321]
nelec by numeric integration = 2.0000000272786984
    CPU time for vxc     12.55 sec, wall time      0.10 sec
    CPU time for df-vj      3.92 sec, wall time      0.03 sec
E1 = -1.893306735770057  Ecoul = 0.98632183426074  Exc = -0.5239841789731537
cycle= 5 E= -1.05298535839676  delta_E= -8.93e-12  |g|= 5.78e-08  |ddm|= 1.74e-05
    CPU time for cycle= 5     18.59 sec, wall time      0.16 sec
  HOMO = -0.301888433656564  LUMO = -0.102346310135876
  mo_energy =
[-0.30188843 -0.10234631  0.08839306  0.14713228  0.22481519  0.22481519
  0.38663334  0.43664623  0.43664623  0.6795706   0.69420395  0.71421032
  1.04968794  1.04968887  1.15581887  1.15581887  1.3419508   1.34195236
  1.36258593  1.53999092  1.53999092  1.65215408  1.65215408  1.72447046
  1.7897343   1.7897343   1.81564944  2.18481872  2.49958877  3.10918345
  3.78292703  3.78292703  3.89420048  3.92084482  3.92084771  4.17709265
  4.17709265  4.24971508  4.24971686  4.36673947  4.36673947  4.36819833
  4.3681992   4.63828273  4.63828273  4.64949004  4.64949004  4.85851647
  4.85852203  4.94043497  5.08440261  5.24795577  5.24795577  5.28134943
  5.28134943  5.36843982  5.9413166   6.04383156  6.04383156  7.83478734
  8.95743938  8.95744116  9.06086545  9.06086545  9.15318607  9.25533209
  9.25533209  9.42468696  9.42468765  9.46393962  9.46394034  9.63813757
  9.63813757 10.25983165 10.25983248 10.44718628 10.51078231 11.09434181
 11.09434181 11.15701036 12.84501248 12.84504494 12.85128164 12.85128164
 12.97260748 12.972639   13.08693236 13.59819149 13.59819149 14.59638864
 14.59642033 14.65682281 14.65682281 14.76055971 14.76055971 14.78967452
 15.00377256 15.00377256 15.08956491 15.08959677 15.57058729 15.83734922
 15.83734922 16.28738512 16.40937236 16.40937236 16.71479652 16.71479652
 17.46372988 18.81852319]
nelec by numeric integration = 2.0000000272787215
    CPU time for vxc     12.51 sec, wall time      0.10 sec
    CPU time for df-vj      4.27 sec, wall time      0.03 sec
E1 = -1.893306750013992  Ecoul = 0.9863218598457282  Exc = -0.5239841903142094
Extra cycle  E= -1.05298535839676  delta_E= -2.66e-15  |g|= 1.01e-08  |ddm|= 2.23e-07
    CPU time for scf_cycle    168.29 sec, wall time      1.61 sec
    CPU time for SCF    168.30 sec, wall time      1.62 sec
converged SCF energy = -1.05298535839676
